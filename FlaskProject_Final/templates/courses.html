{% extends "layout.html" %}
{% block content %}
<div class="container py-4">
  <h2 class="text-warning mb-4">ðŸ“š Dersler</h2>

  <!-- ðŸ” FÄ°LTRE FORMU (select + arama) -->
  <form method="get" class="row g-2 mb-4" id="filterForm">
    <div class="col-md-4">
      <input type="text" name="q" value="{{ q or '' }}" class="form-control"
             placeholder="Kod, ad veya eÄŸitmen ara">
    </div>

    <!-- SÄ±nÄ±f seÃ§imi her zaman formun Ä°Ã‡Ä°NDE -->
    <div class="col-md-3">
      <select name="year" class="form-select"
              onchange="document.getElementById('filterForm').submit()">
        <option value="all" {{ 'selected' if year=='all' }}>TÃ¼m SÄ±nÄ±flar</option>
        <option value="1"   {{ 'selected' if year=='1' }}>1. SÄ±nÄ±f</option>
        <option value="2"   {{ 'selected' if year=='2' }}>2. SÄ±nÄ±f</option>
        <option value="3"   {{ 'selected' if year=='3' }}>3. SÄ±nÄ±f</option>
        <option value="4"   {{ 'selected' if year=='4' }}>4. SÄ±nÄ±f</option>
      </select>
    </div>

    <div class="col-md-2">
      <button class="btn btn-info w-100">Ara</button>
    </div>
  </form>

  <!-- (geri kalan tablo + ekleme formu aynÄ± kalÄ±yor) -->

  <!-- DERS TABLOSU -->
  <table class="table table-dark table-striped align-middle">
    <thead class="table-light">
      <tr>
        <th>#</th><th>Kod</th><th>AdÄ±</th><th>Kredi</th>
        <th>EÄŸitmen</th><th>Ders YÄ±lÄ±</th><th class="text-center">Ä°ÅŸlem</th>
      </tr>
    </thead>
    <tbody>
    {% for c in courses %}
      <tr>
        <td>{{ loop.index }}</td>
        <td>{{ c.code }}</td><td>{{ c.name }}</td>
        <td>{{ c.credit }}</td><td>{{ c.lecturer }}</td>
        <td>{{ c.year }}. SÄ±nÄ±f</td>
        <td class="text-center">
          <form method="post" action="{{ url_for('courses.delete_course', id=c.id) }}"
                onsubmit="return confirm('âš ï¸ Bu ders silinecek ve tÃ¼m not & katkÄ±larÄ± kaldÄ±rÄ±lacak. Emin misiniz?')">
            <input type="hidden" name="confirm" value="yes">
            <button class="btn btn-sm btn-danger">Sil</button>
          </form>
        </td>
      </tr>
    {% else %}
      <tr><td colspan="7" class="text-center text-muted">ðŸ“­ Ders bulunamadÄ±.</td></tr>
    {% endfor %}
    </tbody>
  </table>

  <hr class="my-5">

  <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Yeni Ders Ekle â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <h4 class="mb-3">ðŸ†• Yeni Ders Ekle</h4>
  <form method="post" action="{{ url_for('courses.add_course') }}" class="row gy-3 gx-3 align-items-end">
    <div class="col-md-2">
      <label class="form-label">Ders Kodu</label>
      <input name="code" class="form-control" placeholder="CS101" required>
    </div>
    <div class="col-md-3">
      <label class="form-label">Ders AdÄ±</label>
      <input name="name" class="form-control" placeholder="Programlamaya GiriÅŸ" required>
    </div>
    <div class="col-md-2">
      <label class="form-label">Kredi</label>
      <input name="credit" type="number" class="form-control" placeholder="3" required>
    </div>
    <div class="col-md-3">
      <label class="form-label">EÄŸitmen</label>
      <input name="lecturer" class="form-control" placeholder="Dr. Ahmet YÄ±lmaz" required>
    </div>
    <div class="col-md-2">
      <label class="form-label">YÄ±l</label>
      <select name="year" class="form-select" required>
        <option value="">SeÃ§iniz</option>
        <option value="1">1. YÄ±l</option>
        <option value="2">2. YÄ±l</option>
        <option value="3">3. YÄ±l</option>
        <option value="4">4. YÄ±l</option>
      </select>
    </div>
    <div class="col-12 text-end">
      <button class="btn btn-success px-4">âž• Ekle</button>
    </div>
  </form>

</div>
{% endblock %}
